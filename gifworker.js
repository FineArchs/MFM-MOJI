(()=>{var t={5958:(t,e)=>{var r=Object.defineProperty;r(e,"__esModule",{value:!0}),((t,e)=>{for(var n in e)r(t,n,{get:e[n],enumerable:!0})})(e,{GIFEncoder:()=>C,applyPalette:()=>d,default:()=>E,nearestColor:()=>x,nearestColorIndex:()=>v,nearestColorIndexWithDistance:()=>k,prequantize:()=>p,quantize:()=>y,snapColorsToPalette:()=>A});var n={signature:"GIF",version:"89a",trailer:59,extensionIntroducer:33,applicationExtensionLabel:255,graphicControlExtensionLabel:249,imageSeparator:44,signatureSize:3,versionSize:3,globalColorTableFlagMask:128,colorResolutionMask:112,sortFlagMask:8,globalColorTableSizeMask:7,applicationIdentifierSize:8,applicationAuthCodeSize:3,disposalMethodMask:28,userInputFlagMask:2,transparentColorFlagMask:1,localColorTableFlagMask:128,interlaceFlagMask:64,idSortFlagMask:32,localColorTableSizeMask:7};function a(t=256){let e=0,r=new Uint8Array(t);return{get buffer(){return r.buffer},reset(){e=0},bytesView:()=>r.subarray(0,e),bytes:()=>r.slice(0,e),writeByte(t){n(e+1),r[e]=t,e++},writeBytes(t,a=0,o=t.length){n(e+o);for(let n=0;n<o;n++)r[e++]=t[n+a]},writeBytesView(t,a=0,o=t.byteLength){n(e+o),r.set(t.subarray(a,a+o),e),e+=o}};function n(t){var n=r.length;if(n>=t)return;t=Math.max(t,n*(n<1048576?2:1.125)>>>0),0!=n&&(t=Math.max(t,256));const a=r;r=new Uint8Array(t),e>0&&r.set(a.subarray(0,e),0)}}var o=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535],i=function(t,e,r,n,i=a(512),c=new Uint8Array(256),l=new Int32Array(5003),s=new Int32Array(5003)){const f=l.length,u=Math.max(2,n);c.fill(0),s.fill(0),l.fill(-1);let w=0,y=0;const h=u+1,g=h;let b=!1,p=g,d=(1<<p)-1;const m=1<<h-1,B=m+1;let A=m+2,M=0,v=r[0],k=0;for(let t=f;t<65536;t*=2)++k;k=8-k,i.writeByte(u),C(m);const x=r.length;for(let t=1;t<x;t++)t:{const e=r[t],n=(e<<12)+v;let a=e<<k^v;if(l[a]===n){v=s[a];break t}const o=0===a?1:f-a;for(;l[a]>=0;)if(a-=o,a<0&&(a+=f),l[a]===n){v=s[a];break t}C(v),v=e,A<4096?(s[a]=A++,l[a]=n):(l.fill(-1),A=m+2,b=!0,C(m))}return C(v),C(B),i.writeByte(0),i.bytesView();function C(t){for(w&=o[y],y>0?w|=t<<y:w=t,y+=p;y>=8;)c[M++]=255&w,M>=254&&(i.writeByte(M),i.writeBytesView(c,0,M),M=0),w>>=8,y-=8;if((A>d||b)&&(b?(p=g,d=(1<<p)-1,b=!1):(++p,d=12===p?1<<p:(1<<p)-1)),t==B){for(;y>0;)c[M++]=255&w,M>=254&&(i.writeByte(M),i.writeBytesView(c,0,M),M=0),w>>=8,y-=8;M>0&&(i.writeByte(M),i.writeBytesView(c,0,M),M=0)}}};function c(t,e,r){return t<<8&63488|e<<2&992|r>>3}function l(t,e,r,n){return t>>4|240&e|(240&r)<<4|(240&n)<<8}function s(t,e,r){return t>>4<<8|240&e|r>>4}function f(t,e,r){return t<e?e:t>r?r:t}function u(t){return t*t}function w(t,e,r){var n=0,a=1e100;const o=t[e],i=o.cnt,c=o.ac,l=o.rc,s=o.gc,f=o.bc;for(var w=o.fw;0!=w;w=t[w].fw){const e=t[w],o=e.cnt,h=i*o/(i+o);if(!(h>=a)){var y=0;r&&(y+=h*u(e.ac-c))>=a||(y+=h*u(e.rc-l))>=a||(y+=h*u(e.gc-s))>=a||(y+=h*u(e.bc-f))>=a||(a=y,n=w)}}o.err=a,o.nn=n}function y(t,e,r={}){const{format:n="rgb565",clearAlpha:a=!0,clearAlphaColor:o=0,clearAlphaThreshold:i=0,oneBitAlpha:y=!1}=r;if(!t||!t.buffer)throw new Error("quantize() expected RGBA Uint8Array data");if(!(t instanceof Uint8Array||t instanceof Uint8ClampedArray))throw new Error("quantize() expected RGBA Uint8Array data");const g=new Uint32Array(t.buffer);let b=!1!==r.useSqrt;const p="rgba4444"===n,d=function(t,e){const r=new Array("rgb444"===e?4096:65536),n=t.length;if("rgba4444"===e)for(let e=0;e<n;++e){const n=t[e],a=n>>24&255,o=n>>16&255,i=n>>8&255,c=255&n,s=l(c,i,o,a);let f=s in r?r[s]:r[s]={ac:0,rc:0,gc:0,bc:0,cnt:0,nn:0,fw:0,bk:0,tm:0,mtm:0,err:0};f.rc+=c,f.gc+=i,f.bc+=o,f.ac+=a,f.cnt++}else if("rgb444"===e)for(let e=0;e<n;++e){const n=t[e],a=n>>16&255,o=n>>8&255,i=255&n,c=s(i,o,a);let l=c in r?r[c]:r[c]={ac:0,rc:0,gc:0,bc:0,cnt:0,nn:0,fw:0,bk:0,tm:0,mtm:0,err:0};l.rc+=i,l.gc+=o,l.bc+=a,l.cnt++}else for(let e=0;e<n;++e){const n=t[e],a=n>>16&255,o=n>>8&255,i=255&n,l=c(i,o,a);let s=l in r?r[l]:r[l]={ac:0,rc:0,gc:0,bc:0,cnt:0,nn:0,fw:0,bk:0,tm:0,mtm:0,err:0};s.rc+=i,s.gc+=o,s.bc+=a,s.cnt++}return r}(g,n),m=d.length,B=m-1,A=new Uint32Array(m+1);for(var M=0,v=0;v<m;++v){const t=d[v];if(null!=t){var k=1/t.cnt;p&&(t.ac*=k),t.rc*=k,t.gc*=k,t.bc*=k,d[M++]=t}}var x,C,U;for(u(e)/M<.022&&(b=!1),v=0;v<M-1;++v)d[v].fw=v+1,d[v+1].bk=v,b&&(d[v].cnt=Math.sqrt(d[v].cnt));for(b&&(d[v].cnt=Math.sqrt(d[v].cnt)),v=0;v<M;++v){w(d,v,!1);var F=d[v].err;for(C=++A[0];C>1&&!(d[x=A[U=C>>1]].err<=F);C=U)A[C]=x;A[C]=v}var I=M-e;for(v=0;v<I;){for(var z;;){var E=A[1];if((z=d[E]).tm>=z.mtm&&d[z.nn].mtm<=z.tm)break;for(z.mtm==B?E=A[1]=A[A[0]--]:(w(d,E,!1),z.tm=v),F=d[E].err,C=1;(U=C+C)<=A[0]&&(U<A[0]&&d[A[U]].err>d[A[U+1]].err&&U++,!(F<=d[x=A[U]].err));C=U)A[C]=x;A[C]=E}var q=d[z.nn],S=z.cnt,G=q.cnt;k=1/(S+G),p&&(z.ac=k*(S*z.ac+G*q.ac)),z.rc=k*(S*z.rc+G*q.rc),z.gc=k*(S*z.gc+G*q.gc),z.bc=k*(S*z.bc+G*q.bc),z.cnt+=q.cnt,z.mtm=++v,d[q.bk].fw=q.fw,d[q.fw].bk=q.bk,q.mtm=B}let P=[];var V=0;for(v=0;;++V){let t=f(Math.round(d[v].rc),0,255),e=f(Math.round(d[v].gc),0,255),r=f(Math.round(d[v].bc),0,255),n=255;p&&(n=f(Math.round(d[v].ac),0,255),y&&(n=n<=("number"==typeof y?y:127)?0:255),a&&n<=i&&(t=e=r=o,n=0));const c=p?[t,e,r,n]:[t,e,r];if(h(P,c)||P.push(c),0==(v=d[v].fw))break}return P}function h(t,e){for(let r=0;r<t.length;r++){const n=t[r];let a=n[0]===e[0]&&n[1]===e[1]&&n[2]===e[2],o=!(n.length>=4&&e.length>=4)||n[3]===e[3];if(a&&o)return!0}return!1}function g(t,e){var r,n=0;for(r=0;r<t.length;r++){const a=t[r]-e[r];n+=a*a}return n}function b(t,e){return e>1?Math.round(t/e)*e:t}function p(t,{roundRGB:e=5,roundAlpha:r=10,oneBitAlpha:n=null}={}){const a=new Uint32Array(t.buffer);for(let t=0;t<a.length;t++){const o=a[t];let i=o>>24&255,c=o>>16&255,l=o>>8&255,s=255&o;i=b(i,r),n&&(i=i<=("number"==typeof n?n:127)?0:255),s=b(s,e),l=b(l,e),c=b(c,e),a[t]=i<<24|c<<16|l<<8|s<<0}}function d(t,e,r="rgb565"){if(!t||!t.buffer)throw new Error("quantize() expected RGBA Uint8Array data");if(!(t instanceof Uint8Array||t instanceof Uint8ClampedArray))throw new Error("quantize() expected RGBA Uint8Array data");if(e.length>256)throw new Error("applyPalette() only works with 256 colors or less");const n=new Uint32Array(t.buffer),a=n.length,o="rgb444"===r?4096:65536,i=new Uint8Array(a),f=new Array(o);if("rgba4444"===r)for(let t=0;t<a;t++){const r=n[t],a=r>>24&255,o=r>>16&255,c=r>>8&255,s=255&r,u=l(s,c,o,a),w=u in f?f[u]:f[u]=m(s,c,o,a,e);i[t]=w}else{const t="rgb444"===r?s:c;for(let r=0;r<a;r++){const a=n[r],o=a>>16&255,c=a>>8&255,l=255&a,s=t(l,c,o),u=s in f?f[s]:f[s]=B(l,c,o,e);i[r]=u}}return i}function m(t,e,r,n,a){let o=0,i=1e100;for(let c=0;c<a.length;c++){const l=a[c];let s=M(l[3]-n);s>i||(s+=M(l[0]-t),s>i||(s+=M(l[1]-e),s>i||(s+=M(l[2]-r),s>i||(i=s,o=c))))}return o}function B(t,e,r,n){let a=0,o=1e100;for(let i=0;i<n.length;i++){const c=n[i];let l=M(c[0]-t);l>o||(l+=M(c[1]-e),l>o||(l+=M(c[2]-r),l>o||(o=l,a=i)))}return a}function A(t,e,r=5){if(!t.length||!e.length)return;const n=t.map((t=>t.slice(0,3))),a=r*r,o=t[0].length;for(let r=0;r<e.length;r++){let i=e[r];i=i.length<o?[i[0],i[1],i[2],255]:i.length>o?i.slice(0,3):i.slice();const c=k(n,i.slice(0,3),g),l=c[0],s=c[1];s>0&&s<=a&&(t[l]=i)}}function M(t){return t*t}function v(t,e,r=g){let n=1/0,a=-1;for(let o=0;o<t.length;o++){const i=r(e,t[o]);i<n&&(n=i,a=o)}return a}function k(t,e,r=g){let n=1/0,a=-1;for(let o=0;o<t.length;o++){const i=r(e,t[o]);i<n&&(n=i,a=o)}return[a,n]}function x(t,e,r=g){return t[v(t,e,r)]}function C(t={}){const{initialCapacity:e=4096,auto:r=!0}=t,o=a(e),c=new Uint8Array(256),l=new Int32Array(5003),s=new Int32Array(5003);let f=!1;return{reset(){o.reset(),f=!1},finish(){o.writeByte(n.trailer)},bytes:()=>o.bytes(),bytesView:()=>o.bytesView(),get buffer(){return o.buffer},get stream(){return o},writeHeader:u,writeFrame(t,e,n,a={}){const{transparent:w=!1,transparentIndex:y=0,delay:h=0,palette:g=null,repeat:b=0,colorDepth:p=8,dispose:d=-1}=a;let m=!1;if(r?f||(m=!0,u(),f=!0):m=Boolean(a.first),e=Math.max(0,Math.floor(e)),n=Math.max(0,Math.floor(n)),m){if(!g)throw new Error("First frame must include a { palette } option");!function(t,e,r,n,a=8){const o=128|a-1<<4|z(n.length)-1;F(t,e),F(t,r),t.writeBytes([o,0,0])}(o,e,n,g,p),U(o,g),b>=0&&function(t,e){t.writeByte(33),t.writeByte(255),t.writeByte(11),I(t,"NETSCAPE2.0"),t.writeByte(3),t.writeByte(1),F(t,e),t.writeByte(0)}(o,b)}const B=Math.round(h/10);!function(t,e,r,n,a){var o,i;t.writeByte(33),t.writeByte(249),t.writeByte(4),a<0&&(a=0,n=!1),n?(o=1,i=2):(o=0,i=0),e>=0&&(i=7&e),i<<=2;t.writeByte(0|i|o),F(t,r),t.writeByte(a||0),t.writeByte(0)}(o,d,B,w,y);const A=Boolean(g)&&!m;!function(t,e,r,n){if(t.writeByte(44),F(t,0),F(t,0),F(t,e),F(t,r),n){const e=0,r=0,a=z(n.length)-1;t.writeByte(128|e|r|0|a)}else t.writeByte(0)}(o,e,n,A?g:null),A&&U(o,g),function(t,e,r,n,a=8,o,c,l){i(r,n,e,a,t,o,c,l)}(o,t,e,n,p,c,l,s)}};function u(){I(o,"GIF89a")}}function U(t,e){const r=1<<z(e.length);for(let n=0;n<r;n++){let r=[0,0,0];n<e.length&&(r=e[n]),t.writeByte(r[0]),t.writeByte(r[1]),t.writeByte(r[2])}}function F(t,e){t.writeByte(255&e),t.writeByte(e>>8&255)}function I(t,e){for(var r=0;r<e.length;r++)t.writeByte(e.charCodeAt(r))}function z(t){return Math.max(Math.ceil(Math.log2(t)),1)}var E=C}},e={};function r(n){var a=e[n];if(void 0!==a)return a.exports;var o=e[n]={exports:{}};return t[n](o,o.exports,r),o.exports}r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{"use strict";var t=r(5958);const e=self,n=(0,t.GIFEncoder)();e.addEventListener("message",(r=>{if(r.data.addFrame){const{data:e,transparent:a,width:o,height:i,delay:c}=r.data.addFrame,l=(0,t.quantize)(e,256,{oneBitAlpha:a}),s=(0,t.applyPalette)(e,l);n.writeFrame(s,o,i,{palette:l,delay:c,transparent:a})}else r.data.finish&&(n.finish(),e.postMessage(new Blob([n.bytes()],{type:"image/gif"})))}))})()})();
//# sourceMappingURL=gifworker.js.map